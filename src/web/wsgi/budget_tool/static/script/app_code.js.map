{
  "version": 3,
  "file": "app_code.js",
  "sourceRoot": "",
  "sources": [
    "app_code.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "class window.Subcategory\r\n  constructor: (dict) ->\r\n\r\n    @name = ko.observable(dict.name)\r\n    @remaining = ko.observable(dict.remaining)\r\n    @spent = ko.observable(dict.spent)\r\n    @allocated = ko.observable(dict.allocated)\r\n\r\n    @edit = ko.observable(false)\r\n\r\n    @toggle_edit = =>\r\n      @edit(not @edit())\r\n\r\n    @name_changed = =>\r\n      @toggle_edit()\r\n\r\n\r\nclass window.CategoryDisplay\r\n  constructor: (name, value) ->\r\n    @category = ko.observable(name)\r\n    @allocated = ko.observable(value.allocated)\r\n    @spent = ko.observable(value.spent)\r\n    @remaining = ko.observable(value.remaining)\r\n\r\n    underlyingArray = []\r\n    for subcat in value.subcategories\r\n      underlyingArray.push(new window.Subcategory(subcat))\r\n\r\n    @subcategories = ko.observableArray(underlyingArray)\r\n\r\n\r\n\r\nclass window.ViewModel\r\n  constructor: () ->\r\n    @error_message = ko.observable(\"\")\r\n    @total_income = ko.observable(\"\")\r\n    @total_budgeted = ko.observable(\"\")\r\n    @unaccounted = ko.observable(\"\")\r\n    @categories = ko.observableArray([])\r\n    \r\n    @budget = {}\r\n\r\n    @selected_add_category = ko.observable(\"\")\r\n    @selected_add_subcategory = ko.observable(\"\")\r\n    @add_expense_amount = ko.observable(\"\")\r\n    @add_expense_notes = ko.observable(\"\")\r\n\r\n    @something_changed = (idx1, idx2, d) =>\r\n\r\n      cat = @categories()[idx1].category()\r\n      subcat_idx = -1\r\n\r\n\r\n      for item in @budget\r\n\r\n        if item.Category == cat\r\n          subcat_idx += 1\r\n\r\n        if subcat_idx == idx2\r\n          item['Subcategory'] = d.name()\r\n          item['Allocated'] = d.allocated()\r\n          break\r\n\r\n      d.toggle_edit()\r\n\r\n\r\n\r\n    @show_error = (error_message) =>\r\n      modal = $('#ErrorModal')\r\n      modal.foundation('open')\r\n      @error_message(error_message)\r\n\r\n    @handle_budget_upload = =>\r\n      document.getElementById(\"budget_input_elem\").click()\r\n    @dollars = (amount) ->\r\n      return '$' + amount.toFixed(2)\r\n\r\n    @get_budget_params = =>\r\n\r\n      $.post 'ajax/',\r\n        request: \"ajax_get_budget_parameters\"\r\n        budget: JSON.stringify(@budget)\r\n        (data) =>\r\n\r\n          result = JSON.parse(data)\r\n          if result.Error\r\n            @show_error(result.Message)\r\n            return\r\n\r\n          @total_income(@dollars(result.income))\r\n          @total_budgeted(@dollars(result.budgeted))\r\n          @unaccounted(@dollars(result.unaccounted))\r\n\r\n          underlyingArray = []\r\n          for item of result.bins\r\n            underlyingArray.push(new window.CategoryDisplay(item, result.bins[item]))\r\n\r\n          @categories(underlyingArray)\r\n\r\n    @get_budget_csv = =>\r\n\r\n      file = document.getElementById(\"budget_input_elem\").files[0]\r\n      reader = new FileReader()\r\n      reader.onloadend = (event) =>\r\n        $.post 'ajax/',\r\n          request: \"ajax_upload_budget\"\r\n          csv: event.target.result\r\n          (data) =>\r\n\r\n            result = JSON.parse(data)\r\n            if result.Error\r\n              @show_error(result.Message)\r\n              return\r\n\r\n            @budget = result\r\n            @get_budget_params()\r\n\r\n      reader.readAsBinaryString(file)\r\n\r\n    @add_expense = =>\r\n\r\n      @budget.push({\r\n        'Type': 'Transaction',\r\n        'Category': @selected_add_category().category(),\r\n        'Subcategory': @selected_add_subcategory().name(),\r\n        'Amount': parseFloat(@add_expense_amount()),\r\n        'Notes': @add_expense_notes()\r\n      })\r\n\r\n      @get_budget_params()\r\n\r\n    @download_budget_csv = =>\r\n\r\n      @show_error(\"Download functionality not yet implemented.\")\r\n\r\n    @event_startup = =>\r\n      console.log(\"STARTUP\")\r\n\r\n\r\n# ******************************************************************************\r\n# Setup Knockout.js ViewModel\r\n# ******************************************************************************\r\nwindow.viewmodel = new window.ViewModel()\r\n$ ->\r\n\r\n  ko.applyBindings(window.viewmodel, $('#app_body')[0])\r\n  ko.applyBindings(window.viewmodel, $('#ErrorModal')[0])\r\n\r\n  window.viewmodel.event_startup()\r\n\r\n"
  ]
}